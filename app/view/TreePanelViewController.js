/*
 * File: app/view/TreePanelViewController.js
 *
 * This file was generated by Sencha Architect version 3.2.0.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Ext JS 5.1.x library, under independent license.
 * License of Sencha Architect does not include license for Ext JS 5.1.x. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('SD.view.TreePanelViewController', {
    extend: 'Ext.app.ViewController',
    alias: 'controller.treepanel',

    onTreeMenuAfterRender: function(component, eOpts) {
        var ghUtil = Ext.create('SD.view.GitHubWrapper', {});

        var github = ghUtil.getInstance("d226b4e3bd6447b29da96c5120420f71baf4817d");

        ghUtil.getRepo('ajit-kumar-azad', 'slidedeck');

        ghUtil.getTree('master');

        var html = "<iframe height='268' scrolling='no' src='http://codepen.io/ajit-kumar-azad/embed/{hash}/?height=268&theme-id=0' frameborder='no' allowtransparency='true' allowfullscreen='true' style='width: 800px;'>See the Pen <a href='http://codepen.io/ajit-kumar-azad/pen/{hash}/'>{hash}</a> by Ajit Kumar (<a href='http://codepen.io/ajit-kumar-azad'>@ajit-kumar-azad</a>) on <a href='http://codepen.io'>CodePen</a>.</iframe>";
        var tpl =  Ext.dom.Helper.createTemplate(html);

        ghUtil.getFileContent('master', "README.md", function(err, data) {

            console.log('DATA: ', data);

            //     debugger;

            var el = Ext.dom.Helper.createDom(data);

            var domEl = Ext.get(el);
            //     var hash = Ext.dom.Query.selectNode('code', domEl);
            var hash = domEl.getAttribute('data-slug-hash');

            console.log('CODE: ', hash);

            Ext.getCmp('content-pnl').setHtml(data);

            var elArr = Ext.dom.Query.select('a[href*=http://codepen.io/ajit-kumar-azad/pen]');
            for (var i = 0; i < elArr.length; i++) {
                el = elArr[i];
                console.log('HASH: ', Ext.get(el).getAttribute('text'));

                console.log('EL: ', Ext.get(el).parent());

                tpl.overwrite(Ext.get(el).parent(), {hash: Ext.get(el).getAttribute('text')});
            }
        });
    }

});
